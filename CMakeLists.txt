cmake_minimum_required(VERSION 3.14)
project(Paradox-Platform)

set(PROJECT_DIR ${CMAKE_CURRENT_SOURCE_DIR}/.)

option(PARADOX_PLATFORM_BUILD_TESTS "Build the test executables" OFF)

if(UNIX AND NOT APPLE)
    set(LINUX TRUE)
endif()

if(APPLE)
    add_subdirectory(source/swift swift_framework)
elseif(LINUX)
    if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
        add_subdirectory(source/c c_framework)
        add_subdirectory(source/c++ c++_framework)
    else()
        message(FATAL_ERROR "Must use GNU GCC/G++ Compiler on Linux")
    endif()
elseif(WIN32)
    if(CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
        add_subdirectory(source/c c_framework)
        add_subdirectory(source/c++ c++_framework)
    else()
        message(FATAL_ERROR "Must use Visual Studio C/C++ Compiler on Windows")
    endif()
endif()

if(PARADOX_PLATFORM_BUILD_TESTS)
    if(APPLE)
        add_subdirectory(tests/swift swift_unit_testing)
    elseif(LINUX)
        if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
            add_subdirectory(tests/c c_unit_testing)
            add_subdirectory(tests/c++ c++_unit_testing)
        endif()
    elseif(WIN32)
        if(CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
            add_subdirectory(tests/c c_unit_testing)
            add_subdirectory(tests/c++ c++_unit_testing)
        endif()
    endif()
endif()